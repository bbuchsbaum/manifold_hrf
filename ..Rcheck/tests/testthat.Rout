
R version 4.3.2 (2023-10-31) -- "Eye Holes"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # This file is part of the standard setup for testthat.
> # It is recommended that you do not modify it.
> #
> # Where should you do additional test configuration?
> # Learn more about the roles of various files in:
> # * https://r-pkgs.org/tests.html
> # * https://testthat.r-lib.org/reference/test_package.html#special-files
> 
> library(testthat)
Warning message:
package 'testthat' was built under R version 4.3.3 
> library(manifoldhrf)
> 
> test_check("manifoldhrf")
Woodbury beta: 0.7029469 
Naive beta: 1.128166 
True beta: 1 
Difference: 0.425219 

Debug info:
P_lss dimensions: 2 100 
C_v dimensions: 100 5 
U_v dimensions: 2 5 
V_reg dimensions: 100 5 
p_lss vector length: 100 

=== LSS Implementation Comparison ===
True betas:      1 -0.5 2 0 1.5 -1 0.8 0.3 
Direct LSS:      0.903 -0.469 1.9 0.875 1.462 -1.71 0.663 0 
Corrected:       0.903 -0.469 1.9 0.875 1.462 -1.71 0.663 0 
Current Wood:    0.991 -0.958 1.726 0.56 1.448 -1.997 0.869 0 

=== Differences from Direct ===
Corrected diff:  -3e-06 -1e-06 0 0 -1e-06 -1e-06 -1e-06 0 
Current diff:    0.087238 -0.488495 -0.173263 -0.314975 -0.014198 -0.286566 0.206483 1e-06 

=== Mean Squared Errors ===
Direct MSE:      0.1752 
Corrected MSE:   0.1752 
Current MSE:     0.2113 

=== Simultaneous Estimation ===
Simultaneous:    0.903 -0.469 1.9 0.875 1.462 -1.71 0.663 0 
Diff from true:  -0.097 0.031 -0.1 0.875 -0.038 -0.71 -0.137 -0.3 

=== True LSS vs Woodbury ===
True betas:   2 -1 0 1.5 0.5 
True LSS:     1.839 -1.031 0.044 1.95 0.603 
Woodbury:     1.936 -1.374 -0.218 1.884 0.412 
Difference:   0.0964 -0.3437 -0.2616 -0.066 -0.1917 

P_lss error:  0 
V matrix difference:  4.440892e-16 

Betas comparison:
Reference:   0.0643 -1.199 -1.2024 -0.2411 -2.2547 0.5362 
Current:     0.0643 -1.199 -1.2024 -0.2411 -2.2547 0.5362 
Difference:  0 0 0 0 0 0 

=== Simple Non-overlapping Trials ===
True betas:  2 -1 1.5 
LSS betas:   0.997 -1.508 3.751 
Error:       -1.003 -0.508 2.251 

=== p_lss_vector computation ===
Current implementation norm:  0.1828823 
Manual method 1 norm:         0.1828823 
Manual method 2 norm:         0.1828823 

Difference (current vs P_lss[1,]):  0 
[WARNING] Div at mhrf_qc_report.knit.md line 25 column 1 unclosed at mhrf_qc_report.knit.md line 188 column 1, closing implicitly.
[WARNING] Div at mhrf_qc_report.knit.md line 25 column 1 unclosed at mhrf_qc_report.knit.md line 173 column 1, closing implicitly.

=== Beta Estimates ===
True betas:      2 -1 1.5 0.5 
Direct LSS:      2.1316 -1.2271 1.5903 0 
Woodbury:        2.1394 -1.9019 2.003 0 
Manual:          2.1316 -1.2271 1.5904 0 

=== Differences from Direct ===
Woodbury diff:   0.007773 -0.674755 0.412714 8e-06 
Manual diff:     -2.3e-05 1.3e-05 2e-05 0 

=== Debugging Woodbury Implementation ===
C_v shape:  50 4 
U_v shape:  3 4 
V_regressors_v shape:  50 4 
Projection error:  5.202534e-16 

pc_v_row:  0.0989 -0.006 -0.0375 0 
cv_v_row:  0.1148 0.1382 0.1374 0 
alpha_v_row:  7.8493 7.2811 7.5524 4.5036e+15 

=== Comparison of Methods ===
True betas:       0.328 1.311 1.4 0.306 0.643 0.838 
Direct LSS:       -0.989 0.933 1.896 0.123 1.351 1.688 
Corrected Wood:   -0.989 0.933 1.896 0.123 1.351 1.688 
Current Wood:     -1.15 0.873 1.721 -0.484 0.989 1.531 

=== Errors ===
Direct error:     0.7507 
Corrected error:  0.7507 
Current error:    0.7858 

Max diff (corrected vs direct):  2.687395e-06 
[ FAIL 0 | WARN 19 | SKIP 3 | PASS 862 ]

══ Skipped tests (3) ═══════════════════════════════════════════════════════════
• Requires fmrireg integration (1): 'test-mhrf-lss-interface.R:100:3'
• empty test (2): 'test-lss-correction-validation.R:126:1',
  'test-mhrf-lss-interface.R:3:1'

[ FAIL 0 | WARN 19 | SKIP 3 | PASS 862 ]
> 
> proc.time()
   user  system elapsed 
 23.058   1.286  25.516 
