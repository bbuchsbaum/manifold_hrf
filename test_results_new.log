
R version 4.3.2 (2023-10-31) -- "Eye Holes"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-apple-darwin20 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> devtools::test()
ℹ Testing manifoldhrf
Registered S3 method overwritten by 'future':
  method               from      
  all.equal.connection parallelly
✔ | F W  S  OK | Context

⠏ |          0 | alternating-optimization                                       
✔ |         41 | alternating-optimization

⠏ |          0 | core-algorithm-diagnostics                                     
⠸ |          4 | core-algorithm-diagnostics                                     
⠙ |         12 | core-algorithm-diagnostics                                     
✔ |         59 | core-algorithm-diagnostics

⠏ |          0 | core-voxelfit-engine                                           
⠏ |          0 | core voxel fit engine                                          
✔ |   1     13 | core voxel fit engine
────────────────────────────────────────────────────────────────────────────────
Warning ('test-core-voxelfit-engine.R:52:3'): prepare_lss_fixed_components_core returns matrices of correct size
data length [18] is not a sub-multiple or multiple of the number of rows [10]
Backtrace:
    ▆
 1. ├─base::cbind(1, matrix(rnorm(18), nrow = 10, ncol = 2)) at test-core-voxelfit-engine.R:52:3
 2. └─base::matrix(rnorm(18), nrow = 10, ncol = 2)
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | debug-woodbury                                                 Woodbury beta: 0.5214975 
Naive beta: 1.128166 
True beta: 1 
Difference: 0.6066684 

Debug info:
P_lss dimensions: 2 100 
C_v dimensions: 100 5 
U_v dimensions: 2 5 
V_reg dimensions: 100 5 
p_lss vector length: 100 

⠏ |          0 | design-truncation                                              
⠏ |          0 | Design matrix truncation                                       
✔ |   1      3 | Design matrix truncation
────────────────────────────────────────────────────────────────────────────────
Warning ('test-design-truncation.R:12:3'): .create_design_matrices detects truncated HRFs
1 event HRFs truncated at end of run
Backtrace:
    ▆
 1. └─manifoldhrf:::.create_design_matrices(...) at test-design-truncation.R:12:3
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | determine-n-jobs                                               
✔ |          3 | determine-n-jobs

⠏ |          0 | fallback-cascade                                               
⠏ |          0 | fallback cascade                                               
✔ |   1      3 | fallback cascade
────────────────────────────────────────────────────────────────────────────────
Warning ('test-fallback-cascade.R:8:3'): run_with_fallback_cascade falls back when manifold fails
Manifold approach failed: invalid arguments
Backtrace:
    ▆
 1. └─manifoldhrf::run_with_fallback_cascade(Y, X, params) at test-fallback-cascade.R:8:3
 2.   └─base::tryCatch(...) at manifold_hrf/R/fallback_memory_safety.R:217:3
 3.     └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.       └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.         └─value[[3L]](cond)
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | fmrireg-benchmarks                                             
⠋ |          1 | fmrireg-benchmarks                                             
⠴ |   1  1   4 | fmrireg-benchmarks                                             
✔ |   6  1  10 | fmrireg-benchmarks
────────────────────────────────────────────────────────────────────────────────
Warning ('test-fmrireg-benchmarks.R:282:3'): M-HRF-LSS handles variable HRFs across voxels
the standard deviation is zero
Backtrace:
    ▆
 1. └─stats::cor(hrf_shapes) at test-fmrireg-benchmarks.R:282:3

Warning ('test-fmrireg-benchmarks.R:496:3'): M-HRF-LSS handles complex realistic scenario
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at test-fmrireg-benchmarks.R:496:3

Warning ('test-fmrireg-benchmarks.R:496:3'): M-HRF-LSS handles complex realistic scenario
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at test-fmrireg-benchmarks.R:496:3

Warning ('test-fmrireg-benchmarks.R:496:3'): M-HRF-LSS handles complex realistic scenario
  - Library is ill-conditioned (condition number: 5.05e+16)
Backtrace:
    ▆
 1. └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at test-fmrireg-benchmarks.R:496:3

Warning ('test-fmrireg-benchmarks.R:496:3'): M-HRF-LSS handles complex realistic scenario
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at test-fmrireg-benchmarks.R:496:3

Warning ('test-fmrireg-benchmarks.R:496:3'): M-HRF-LSS handles complex realistic scenario
Target dimension 4 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at test-fmrireg-benchmarks.R:496:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/soundness_improvements.R:230:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/soundness_improvements.R:250:5
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | fmrireg-helpers                                                
⠏ |          0 | fmrireg helper utilities                                       
✔ |         12 | fmrireg helper utilities

⠏ |          0 | identifiability-fallback                                       
⠏ |          0 | identifiability fallback                                       
✔ |          4 | identifiability fallback

⠏ |          0 | input-validation-core                                          
⠏ |          0 | input validation core                                          
⠼ |          5 | input validation core                                          
✔ |          5 | input validation core

⠏ |          0 | lss-correction-validation                                      
=== LSS Implementation Comparison ===
True betas:      1 -0.5 2 0 1.5 -1 0.8 0.3 
Direct LSS:      0.903 -0.469 1.9 0.875 1.462 -1.71 0.663 0 
Corrected:       1.107 -0.793 1.793 0.722 1.598 -1.81 0.935 0 
Current Wood:    0.777 -0.826 1.436 0.476 1.253 -1.717 0.75 0 

=== Differences from Direct ===
Corrected diff:  0.203588 -0.324309 -0.106797 -0.153517 0.135818 -0.099671 0.27179 0 
Current diff:    -0.126707 -0.357213 -0.46383 -0.399135 -0.208885 -0.006512 0.087608 0 

=== Mean Squared Errors ===
Direct MSE:      0.1752 
Corrected MSE:   0.1795 
Current MSE:     0.1711 

=== Simultaneous Estimation ===
Simultaneous:    0.903 -0.469 1.9 0.875 1.462 -1.71 0.663 0 
Diff from true:  -0.097 0.031 -0.1 0.875 -0.038 -0.71 -0.137 -0.3 

=== True LSS vs Woodbury ===
True betas:   2 -1 0 1.5 0.5 
True LSS:     1.839 -1.031 0.044 1.95 0.603 
Woodbury:     1.619 -1.265 -0.205 1.688 0.326 
Difference:   -0.2197 -0.234 -0.2483 -0.2626 -0.2769 

✖ | 1 1  1   0 | lss-correction-validation
────────────────────────────────────────────────────────────────────────────────
Warning ('test-lss-correction-validation.R:70:3'): Corrected LSS implementation matches ground truth
Trial regressors are rank deficient for this voxel: rank 7 < 8
Backtrace:
    ▆
 1. └─manifoldhrf::run_lss_for_voxel_corrected_full(...) at test-lss-correction-validation.R:70:3

Failure ('test-lss-correction-validation.R:126:3'): Corrected LSS implementation matches ground truth
Corrected implementation should match simultaneous estimation is not strictly less than 1e-04. Difference: 0.324
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | lss-formula-verification                                       
P_lss error:  2.775558e-17 
V matrix difference:  4.440892e-16 

Betas comparison:
Reference:   0.0643 -1.199 -1.2024 -0.2411 -2.2547 0.5362 
Current:     0.0635 -1.1791 -1.3923 -0.2468 -1.8883 0.558 
Difference:  -0.000813 0.019888 -0.18988 -0.005706 0.366318 0.021854 

=== Simple Non-overlapping Trials ===
True betas:  2 -1 1.5 
LSS betas:   0.997 -1.508 3.751 
Error:       -1.003 -0.508 2.251 

=== p_lss_vector computation ===
Current implementation norm:  0.1828823 
Manual method 1 norm:         0.1828823 
Manual method 2 norm:         0.1828823 

Difference (current vs P_lss[1,]):  0 

✔ |   6      4 | lss-formula-verification
────────────────────────────────────────────────────────────────────────────────
Warning ('test-lss-formula-verification.R:88:5'): Current LSS formula matches reference implementation
Trial regressors are rank deficient for this voxel: rank 1 < 6
Backtrace:
    ▆
 1. └─manifoldhrf::run_lss_for_voxel_corrected_full(...) at test-lss-formula-verification.R:88:5

Warning ('test-lss-formula-verification.R:88:5'): Current LSS formula matches reference implementation
Trial regressors are rank deficient for this voxel: rank 1 < 6
Backtrace:
    ▆
 1. └─manifoldhrf::run_lss_for_voxel_corrected_full(...) at test-lss-formula-verification.R:88:5

Warning ('test-lss-formula-verification.R:88:5'): Current LSS formula matches reference implementation
Trial regressors are rank deficient for this voxel: rank 1 < 6
Backtrace:
    ▆
 1. └─manifoldhrf::run_lss_for_voxel_corrected_full(...) at test-lss-formula-verification.R:88:5

Warning ('test-lss-formula-verification.R:88:5'): Current LSS formula matches reference implementation
Trial regressors are rank deficient for this voxel: rank 1 < 6
Backtrace:
    ▆
 1. └─manifoldhrf::run_lss_for_voxel_corrected_full(...) at test-lss-formula-verification.R:88:5

Warning ('test-lss-formula-verification.R:88:5'): Current LSS formula matches reference implementation
Trial regressors are rank deficient for this voxel: rank 1 < 6
Backtrace:
    ▆
 1. └─manifoldhrf::run_lss_for_voxel_corrected_full(...) at test-lss-formula-verification.R:88:5

Warning ('test-lss-formula-verification.R:88:5'): Current LSS formula matches reference implementation
Trial regressors are rank deficient for this voxel: rank 1 < 6
Backtrace:
    ▆
 1. └─manifoldhrf::run_lss_for_voxel_corrected_full(...) at test-lss-formula-verification.R:88:5
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | lss-loop-core                                                  
✔ |          2 | lss-loop-core

⠏ |          0 | lss-separate                                                   
✖ | 1        1 | lss-separate
────────────────────────────────────────────────────────────────────────────────
Failure ('test-lss-separate.R:100:3'): run_lss_for_voxel_corrected_full matches LS-S
`beta_full` not equal to `beta_manual`.
Attributes: < Modes: list, NULL >
Attributes: < Lengths: 1, 0 >
Attributes: < names for target but not for current >
Attributes: < current is not list-like >
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | lss                                                            
⠸ |   1     33 | lss                                                            
✖ | 1 1     47 | lss [1.6s]
────────────────────────────────────────────────────────────────────────────────
Warning ('test-lss.R:233:3'): run_lss_for_voxel_corrected_full works correctly
Trial regressors are rank deficient for this voxel: rank 28 < 30
Backtrace:
    ▆
 1. └─manifoldhrf::run_lss_for_voxel_corrected_full(...) at test-lss.R:233:3

Failure ('test-lss.R:288:3'): run_lss_for_voxel_corrected_full validates inputs
`run_lss_for_voxel_corrected_full(...)` did not throw an error.
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | manifold-construction                                          
⠸ |      1  33 | manifold-construction                                          
✔ |      1  33 | manifold-construction

⠏ |          0 | mhrf-lss-interface                                             
⠙ |      2  30 | mhrf-lss-interface                                             
✔ |      2  41 | mhrf-lss-interface

⠏ |          0 | mhrf-lss-parameters                                            
✔ |          4 | mhrf-lss-parameters

⠏ |          0 | neuroimaging-wrappers                                          
⠼ |   2     23 | neuroimaging-wrappers                                          
✔ |   6  1  44 | neuroimaging-wrappers [6.2s]
────────────────────────────────────────────────────────────────────────────────
Warning ('test-neuroimaging-wrappers.R:38:3'): construct_hrf_manifold_nim works with half-cosine library
Target dimension 4 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf::construct_hrf_manifold_nim(...) at test-neuroimaging-wrappers.R:38:3
 2.   └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/neuroimaging_wrappers.R:203:3

Warning ('test-neuroimaging-wrappers.R:75:3'): construct_hrf_manifold_nim handles custom matrix input
Target dimension 4 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf::construct_hrf_manifold_nim(...) at test-neuroimaging-wrappers.R:75:3
 2.   └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/neuroimaging_wrappers.R:203:3

Warning ('test-neuroimaging-wrappers.R:152:3'): print and summary methods work for mhrf_manifold
Target dimension 4 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf::construct_hrf_manifold_nim(...) at test-neuroimaging-wrappers.R:152:3
 2.   └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/neuroimaging_wrappers.R:203:3

Warning ('test-neuroimaging-wrappers.R:219:3'): construct_hrf_manifold_nim evaluates fmrireg HRF objects
HRF library has only 2 HRFs but target manifold dimension is 2. Adjusting target.
Backtrace:
    ▆
 1. └─manifoldhrf::construct_hrf_manifold_nim(...) at test-neuroimaging-wrappers.R:219:3

Warning ('test-neuroimaging-wrappers.R:219:3'): construct_hrf_manifold_nim evaluates fmrireg HRF objects
Adjusting k_local_nn_for_sigma from 7 to 1 due to small library size (N=2)
Backtrace:
    ▆
 1. └─manifoldhrf::construct_hrf_manifold_nim(...) at test-neuroimaging-wrappers.R:219:3

Warning ('test-neuroimaging-wrappers.R:241:3'): subject-level wrapper runs on minimal data
Target dimension 2 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf::construct_hrf_manifold_nim(...) at test-neuroimaging-wrappers.R:241:3
 2.   └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/neuroimaging_wrappers.R:203:3
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | output-dir                                                     
⠏ |          0 | Output directory handling                                      Validating data compatibility with preset...
✓ Data appears compatible with preset

⠹ |   2      1 | Output directory handling                                      
✔ |   5      4 | Output directory handling
────────────────────────────────────────────────────────────────────────────────
Warning ('test-output-dir.R:21:3'): mhrf_analyze creates missing output directory
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-output-dir.R:21:3
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-output-dir.R:21:3'): mhrf_analyze creates missing output directory
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-output-dir.R:21:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-output-dir.R:21:3'): mhrf_analyze creates missing output directory
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-output-dir.R:21:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-output-dir.R:21:3'): mhrf_analyze creates missing output directory
  - Library is ill-conditioned (condition number: 1.79e+202)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-output-dir.R:21:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-output-dir.R:21:3'): mhrf_analyze creates missing output directory
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-output-dir.R:21:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | parallel-utils                                                 
⠏ |          0 | parallel utilities                                             
✔ |          2 | parallel utilities

⠏ |          0 | plot-trial-betas                                               
✔ |          1 | plot-trial-betas

⠏ |          0 | qc-report                                                      [WARNING] Div at mhrf_qc_report.knit.md line 26 column 1 unclosed at mhrf_qc_report.knit.md line 211 column 1, closing implicitly.

⠋ |          1 | qc-report                                                      [WARNING] Div at mhrf_qc_report.knit.md line 26 column 1 unclosed at mhrf_qc_report.knit.md line 196 column 1, closing implicitly.

⠦ |         27 | qc-report                                                      
✔ |         36 | qc-report [2.6s]

⠏ |          0 | select-manifold-dim                                            
✔ |          5 | select-manifold-dim

⠏ |          0 | simulate-dataset                                               
⠏ |          0 | simulate_mhrf_dataset                                          
✔ |          5 | simulate_mhrf_dataset

⠏ |          0 | smart-initialize                                               
✔ |          9 | smart-initialize

⠏ |          0 | soundness-adversarial                                          
✔ |   4     39 | soundness-adversarial
────────────────────────────────────────────────────────────────────────────────
Warning ('test-soundness-adversarial.R:21:5'): ADVERSARIAL: Handles pathological all-zero input
Excluded 10 low-quality voxels
Backtrace:
     ▆
  1. ├─testthat::expect_no_error(...) at test-soundness-adversarial.R:20:3
  2. │ └─testthat:::expect_no_(...)
  3. │   └─testthat:::quasi_capture(enquo(object), NULL, capture)
  4. │     ├─testthat (local) .capture(...)
  5. │     │ └─rlang::try_fetch(...)
  6. │     │   ├─base::tryCatch(...)
  7. │     │   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
  8. │     │   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
  9. │     │   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 10. │     │   └─base::withCallingHandlers(...)
 11. │     └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 12. └─manifoldhrf::screen_voxels(Y_zeros) at test-soundness-adversarial.R:21:5

Warning ('test-soundness-adversarial.R:34:3'): ADVERSARIAL: Handles single constant value data
Data appears to be integer-valued. Consider converting to percent signal change.
Backtrace:
    ▆
 1. └─manifoldhrf::check_and_scale_data(Y_constant) at test-soundness-adversarial.R:34:3

Warning ('test-soundness-adversarial.R:58:3'): ADVERSARIAL: Handles single spike data
Excluded 14 low-quality voxels
Backtrace:
    ▆
 1. └─manifoldhrf::screen_voxels(Y_spike) at test-soundness-adversarial.R:58:3

Warning ('test-soundness-adversarial.R:152:3'): ADVERSARIAL: Handles empty HRF library
the standard deviation is zero
Backtrace:
    ▆
 1. └─manifoldhrf:::check_hrf_library_quality(L_empty) at test-soundness-adversarial.R:152:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/soundness_improvements.R:20:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─stats::cor(L_library_matrix) at manifold_hrf/R/soundness_improvements.R:21:5
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | soundness-improvements                                         Validating data compatibility with preset...
✓ Data appears compatible with preset
[2025-06-03 23:06:08] INFO: M-HRF-LSS workflow initialized with 'balanced' preset
[2025-06-03 23:06:08] INFO: Test message

⠙ |   2     70 | soundness-improvements                                         
⠴ |   4     82 | soundness-improvements                                         
✔ |   6    131 | soundness-improvements
────────────────────────────────────────────────────────────────────────────────
Warning ('test-soundness-improvements.R:42:3'): HRF library quality check works correctly
the standard deviation is zero
Backtrace:
    ▆
 1. └─manifoldhrf:::check_hrf_library_quality(L_zero) at test-soundness-improvements.R:42:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/soundness_improvements.R:20:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─stats::cor(L_library_matrix) at manifold_hrf/R/soundness_improvements.R:21:5

Warning ('test-soundness-improvements.R:100:3'): Robust manifold construction with fallback works
Target dimension 3 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at test-soundness-improvements.R:100:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/soundness_improvements.R:230:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/soundness_improvements.R:250:5

Warning ('test-soundness-improvements.R:419:3'): Voxel screening identifies bad voxels
Excluded 5 low-quality voxels
Backtrace:
    ▆
 1. └─manifoldhrf::screen_voxels(Y_data) at test-soundness-improvements.R:419:3

Warning ('test-soundness-improvements.R:419:3'): Voxel screening identifies bad voxels
Flagged 5 voxels with potential artifacts
Backtrace:
    ▆
 1. └─manifoldhrf::screen_voxels(Y_data) at test-soundness-improvements.R:419:3

Warning ('test-soundness-improvements.R:469:3'): Data scaling check works
Data values very large (median > 1e6). Auto-scaling applied.
Backtrace:
    ▆
 1. └─manifoldhrf::check_and_scale_data(Y_large) at test-soundness-improvements.R:469:3

Warning ('test-soundness-improvements.R:476:3'): Data scaling check works
Data values very small (median < 1e-6). Auto-scaling applied.
Backtrace:
    ▆
 1. └─manifoldhrf::check_and_scale_data(Y_small) at test-soundness-improvements.R:476:3
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | spatial-smoothing                                              
⠏ |         50 | spatial-smoothing                                              
✔ |         58 | spatial-smoothing

⠏ |          0 | taylor-series-utils                                            
⠏ |          0 | Taylor series utilities                                        
✔ |          1 | Taylor series utilities

⠏ |          0 | unified-interface                                              Validating data compatibility with preset...
✓ Data appears compatible with preset

⠸ |   4      0 | unified-interface                                              Validating data compatibility with preset...
✓ Data appears compatible with preset
Validating data compatibility with preset...
✓ Data appears compatible with preset

⠦ |   13     14 | unified-interface                                             Validating data compatibility with preset...
✓ Data appears compatible with preset
Validating data compatibility with preset...
✓ Data appears compatible with preset

⠋ |   21     20 | unified-interface                                             Validating data compatibility with preset...
✓ Data appears compatible with preset

M-HRF-LSS Analysis
==================

Validating inputs...

M-HRF-LSS Analysis
==================

Validating inputs...

M-HRF-LSS Analysis
==================

Validating inputs...
Validating data compatibility with preset...
✓ Data appears compatible with preset

⠏ |   31     39 | unified-interface                                             Validating data compatibility with preset...
✓ Data appears compatible with preset
Validating data compatibility with preset...

⠸ |   41     43 | unified-interface                                             ⚠️  Potential issues detected:
   - Design matrix 1 is rank deficient
   - Design matrix 2 is rank deficient

Consider using 'robust' preset or addressing these issues.
Validating data compatibility with preset...
✓ Data appears compatible with preset

⠙ |   53     49 | unified-interface                                             Validating data compatibility with preset...
✓ Data appears compatible with preset
Validating data compatibility with preset...
✓ Data appears compatible with preset

⠼ |   63     52 | unified-interface                                             
✔ |   67     69 | unified-interface
────────────────────────────────────────────────────────────────────────────────
Warning ('test-unified-interface.R:18:3'): Basic mhrf_analyze interface works
Some events are very close together (min gap: 0.68 s)
  This may cause collinearity issues
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:18:3
 2.   └─manifoldhrf:::.validate_events(...) at manifold_hrf/R/mhrf_lss.R:135:3

Warning ('test-unified-interface.R:18:3'): Basic mhrf_analyze interface works
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:18:3
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:18:3'): Basic mhrf_analyze interface works
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:18:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:18:3'): Basic mhrf_analyze interface works
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:18:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:18:3'): Basic mhrf_analyze interface works
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:18:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:18:3'): Basic mhrf_analyze interface works
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:18:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
Target dimension 3 is much lower than auto-selected 9 (for 90.0% variance)
Backtrace:
     ▆
  1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
  2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
  3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
  4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
  5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
  6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
  7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5
  8.       ├─base::tryCatch(...) at manifold_hrf/R/soundness_improvements.R:230:3
  9.       │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 10.       │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 11.       │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 12.       └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/soundness_improvements.R:250:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:60:5'): mhrf_analyze works with different presets
Target dimension 4 is much lower than auto-selected 9 (for 90.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:60:5
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/mhrf_lss.R:731:5

Warning ('test-unified-interface.R:88:3'): mhrf_analyze handles custom parameters
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:88:3
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:88:3'): mhrf_analyze handles custom parameters
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:88:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:88:3'): mhrf_analyze handles custom parameters
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:88:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:88:3'): mhrf_analyze handles custom parameters
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:88:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:88:3'): mhrf_analyze handles custom parameters
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:88:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:88:3'): mhrf_analyze handles custom parameters
Target dimension 3 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
     ▆
  1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:88:3
  2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
  3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
  4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
  5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
  6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
  7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5
  8.       ├─base::tryCatch(...) at manifold_hrf/R/soundness_improvements.R:230:3
  9.       │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 10.       │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 11.       │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 12.       └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/soundness_improvements.R:250:5

Warning ('test-unified-interface.R:116:3'): mhrf_analyze S3 methods work correctly
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:116:3
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:116:3'): mhrf_analyze S3 methods work correctly
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:116:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:116:3'): mhrf_analyze S3 methods work correctly
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:116:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:116:3'): mhrf_analyze S3 methods work correctly
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:116:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:116:3'): mhrf_analyze S3 methods work correctly
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:116:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:197:3'): mhrf_analyze handles edge cases
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:197:3
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:197:3'): mhrf_analyze handles edge cases
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:197:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:197:3'): mhrf_analyze handles edge cases
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:197:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:197:3'): mhrf_analyze handles edge cases
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:197:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:197:3'): mhrf_analyze handles edge cases
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:197:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:215:3'): mhrf_analyze handles edge cases
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:215:3
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:215:3'): mhrf_analyze handles edge cases
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:215:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:215:3'): mhrf_analyze handles edge cases
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:215:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:215:3'): mhrf_analyze handles edge cases
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:215:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:215:3'): mhrf_analyze handles edge cases
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:215:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:242:3'): mhrf_analyze trial-wise estimation works
Design matrix is rank deficient: rank 15 < 25 columns
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:242:3
 2.   └─params$validate_data(Y_matrix, X_condition_list) at manifold_hrf/R/mhrf_lss.R:210:5
 3.     └─manifoldhrf::check_design_rank(X_design_list[[i]]) at manifold_hrf/R/soundness_improvements.R:584:7

Warning ('test-unified-interface.R:242:3'): mhrf_analyze trial-wise estimation works
Design matrix is rank deficient: rank 15 < 25 columns
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:242:3
 2.   └─params$validate_data(Y_matrix, X_condition_list) at manifold_hrf/R/mhrf_lss.R:210:5
 3.     └─manifoldhrf::check_design_rank(X_design_list[[i]]) at manifold_hrf/R/soundness_improvements.R:584:7

Warning ('test-unified-interface.R:242:3'): mhrf_analyze trial-wise estimation works
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:242:3
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:242:3'): mhrf_analyze trial-wise estimation works
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:242:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:242:3'): mhrf_analyze trial-wise estimation works
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:242:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:242:3'): mhrf_analyze trial-wise estimation works
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:242:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:242:3'): mhrf_analyze trial-wise estimation works
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:242:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:271:3'): mhrf_analyze respects voxel masking
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:271:3
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:271:3'): mhrf_analyze respects voxel masking
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:271:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:271:3'): mhrf_analyze respects voxel masking
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:271:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:271:3'): mhrf_analyze respects voxel masking
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:271:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:271:3'): mhrf_analyze respects voxel masking
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:271:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:296:3'): mhrf_analyze progress tracking works
HRF library has quality issues. Consider using a different library.
Backtrace:
     ▆
  1. ├─testthat::expect_output(...) at test-unified-interface.R:296:3
  2. │ └─testthat:::quasi_capture(...)
  3. │   ├─testthat (local) .capture(...)
  4. │   │ └─testthat::capture_output_lines(code, print, width = width)
  5. │   │   └─testthat:::eval_with_output(code, print = print, width = width)
  6. │   │     ├─withr::with_output_sink(path, withVisible(code))
  7. │   │     │ └─base::force(code)
  8. │   │     └─base::withVisible(code)
  9. │   └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 10. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 1)
 11.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:296:3'): mhrf_analyze progress tracking works
HRF library has quality issues:
Backtrace:
     ▆
  1. ├─testthat::expect_output(...) at test-unified-interface.R:296:3
  2. │ └─testthat:::quasi_capture(...)
  3. │   ├─testthat (local) .capture(...)
  4. │   │ └─testthat::capture_output_lines(code, print, width = width)
  5. │   │   └─testthat:::eval_with_output(code, print = print, width = width)
  6. │   │     ├─withr::with_output_sink(path, withVisible(code))
  7. │   │     │ └─base::force(code)
  8. │   │     └─base::withVisible(code)
  9. │   └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 10. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 1)
 11.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 12.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 13.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 14.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 15.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 16.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:296:3'): mhrf_analyze progress tracking works
  - Found 4950 near-duplicate HRFs
Backtrace:
     ▆
  1. ├─testthat::expect_output(...) at test-unified-interface.R:296:3
  2. │ └─testthat:::quasi_capture(...)
  3. │   ├─testthat (local) .capture(...)
  4. │   │ └─testthat::capture_output_lines(code, print, width = width)
  5. │   │   └─testthat:::eval_with_output(code, print = print, width = width)
  6. │   │     ├─withr::with_output_sink(path, withVisible(code))
  7. │   │     │ └─base::force(code)
  8. │   │     └─base::withVisible(code)
  9. │   └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 10. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 1)
 11.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 12.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 13.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 14.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 15.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 16.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:296:3'): mhrf_analyze progress tracking works
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
     ▆
  1. ├─testthat::expect_output(...) at test-unified-interface.R:296:3
  2. │ └─testthat:::quasi_capture(...)
  3. │   ├─testthat (local) .capture(...)
  4. │   │ └─testthat::capture_output_lines(code, print, width = width)
  5. │   │   └─testthat:::eval_with_output(code, print = print, width = width)
  6. │   │     ├─withr::with_output_sink(path, withVisible(code))
  7. │   │     │ └─base::force(code)
  8. │   │     └─base::withVisible(code)
  9. │   └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 10. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 1)
 11.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 12.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 13.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 14.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 15.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 16.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:296:3'): mhrf_analyze progress tracking works
  - Low diversity in HRF shapes
Backtrace:
     ▆
  1. ├─testthat::expect_output(...) at test-unified-interface.R:296:3
  2. │ └─testthat:::quasi_capture(...)
  3. │   ├─testthat (local) .capture(...)
  4. │   │ └─testthat::capture_output_lines(code, print, width = width)
  5. │   │   └─testthat:::eval_with_output(code, print = print, width = width)
  6. │   │     ├─withr::with_output_sink(path, withVisible(code))
  7. │   │     │ └─base::force(code)
  8. │   │     └─base::withVisible(code)
  9. │   └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 10. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 1)
 11.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 12.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 13.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 14.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 15.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 16.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:303:5'): mhrf_analyze progress tracking works
HRF library has quality issues. Consider using a different library.
Backtrace:
     ▆
  1. ├─testthat::expect_no_error(...) at test-unified-interface.R:302:3
  2. │ └─testthat:::expect_no_(...)
  3. │   └─testthat:::quasi_capture(enquo(object), NULL, capture)
  4. │     ├─testthat (local) .capture(...)
  5. │     │ └─rlang::try_fetch(...)
  6. │     │   ├─base::tryCatch(...)
  7. │     │   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
  8. │     │   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
  9. │     │   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 10. │     │   └─base::withCallingHandlers(...)
 11. │     └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 12. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 0) at test-unified-interface.R:303:5
 13.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:303:5'): mhrf_analyze progress tracking works
HRF library has quality issues:
Backtrace:
     ▆
  1. ├─testthat::expect_no_error(...) at test-unified-interface.R:302:3
  2. │ └─testthat:::expect_no_(...)
  3. │   └─testthat:::quasi_capture(enquo(object), NULL, capture)
  4. │     ├─testthat (local) .capture(...)
  5. │     │ └─rlang::try_fetch(...)
  6. │     │   ├─base::tryCatch(...)
  7. │     │   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
  8. │     │   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
  9. │     │   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 10. │     │   └─base::withCallingHandlers(...)
 11. │     └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 12. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 0) at test-unified-interface.R:303:5
 13.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 14.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 15.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 16.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 17.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 18.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:303:5'): mhrf_analyze progress tracking works
  - Found 4950 near-duplicate HRFs
Backtrace:
     ▆
  1. ├─testthat::expect_no_error(...) at test-unified-interface.R:302:3
  2. │ └─testthat:::expect_no_(...)
  3. │   └─testthat:::quasi_capture(enquo(object), NULL, capture)
  4. │     ├─testthat (local) .capture(...)
  5. │     │ └─rlang::try_fetch(...)
  6. │     │   ├─base::tryCatch(...)
  7. │     │   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
  8. │     │   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
  9. │     │   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 10. │     │   └─base::withCallingHandlers(...)
 11. │     └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 12. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 0) at test-unified-interface.R:303:5
 13.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 14.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 15.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 16.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 17.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 18.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:303:5'): mhrf_analyze progress tracking works
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
     ▆
  1. ├─testthat::expect_no_error(...) at test-unified-interface.R:302:3
  2. │ └─testthat:::expect_no_(...)
  3. │   └─testthat:::quasi_capture(enquo(object), NULL, capture)
  4. │     ├─testthat (local) .capture(...)
  5. │     │ └─rlang::try_fetch(...)
  6. │     │   ├─base::tryCatch(...)
  7. │     │   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
  8. │     │   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
  9. │     │   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 10. │     │   └─base::withCallingHandlers(...)
 11. │     └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 12. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 0) at test-unified-interface.R:303:5
 13.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 14.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 15.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 16.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 17.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 18.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:303:5'): mhrf_analyze progress tracking works
  - Low diversity in HRF shapes
Backtrace:
     ▆
  1. ├─testthat::expect_no_error(...) at test-unified-interface.R:302:3
  2. │ └─testthat:::expect_no_(...)
  3. │   └─testthat:::quasi_capture(enquo(object), NULL, capture)
  4. │     ├─testthat (local) .capture(...)
  5. │     │ └─rlang::try_fetch(...)
  6. │     │   ├─base::tryCatch(...)
  7. │     │   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
  8. │     │   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
  9. │     │   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 10. │     │   └─base::withCallingHandlers(...)
 11. │     └─rlang::eval_bare(quo_get_expr(.quo), quo_get_env(.quo))
 12. └─manifoldhrf::mhrf_analyze(Y_data, events, TR = 2, verbose = 0) at test-unified-interface.R:303:5
 13.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 14.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 15.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 16.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 17.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 18.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:319:3'): mhrf_analyze metadata is complete
HRF library has quality issues. Consider using a different library.
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:319:3
 2.   └─manifoldhrf:::.prepare_hrf_library(...) at manifold_hrf/R/mhrf_lss.R:216:3

Warning ('test-unified-interface.R:319:3'): mhrf_analyze metadata is complete
HRF library has quality issues:
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:319:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:319:3'): mhrf_analyze metadata is complete
  - Found 4950 near-duplicate HRFs
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:319:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:319:3'): mhrf_analyze metadata is complete
  - Library is ill-conditioned (condition number: Inf)
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:319:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5

Warning ('test-unified-interface.R:319:3'): mhrf_analyze metadata is complete
  - Low diversity in HRF shapes
Backtrace:
    ▆
 1. └─manifoldhrf::mhrf_analyze(...) at test-unified-interface.R:319:3
 2.   ├─base::tryCatch(...) at manifold_hrf/R/mhrf_lss.R:248:3
 3.   │ └─base (local) tryCatchList(expr, classes, parentenv, handlers)
 4.   │   └─base (local) tryCatchOne(expr, names, parentenv, handlers[[1L]])
 5.   │     └─base (local) doTryCatch(return(expr), name, parentenv, handler)
 6.   └─manifoldhrf:::.run_manifold_construction(...) at manifold_hrf/R/mhrf_lss.R:249:5
 7.     └─manifoldhrf::get_manifold_basis_reconstructor_robust(...) at manifold_hrf/R/mhrf_lss.R:723:5
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | utils-operators                                                
✔ |          3 | utils-operators

⠏ |          0 | validation-simulation                                          
⠹ |   3      0 | validation-simulation                                          
⠦ |   7     50 | validation-simulation                                          
⠧ |   26     92 | validation-simulation                                         
⠋ |   68     93 | validation-simulation                                         
✔ |   68     98 | validation-simulation
────────────────────────────────────────────────────────────────────────────────
Warning ('test-validation-simulation.R:8:3'): run_mhrf_lss_simulation works with basic parameters
Z_confounds_matrix is rank deficient; using independent columns only
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:8:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::project_out_confounds_core(...) at manifold_hrf/R/validation_simulation.R:663:3

Warning ('test-validation-simulation.R:8:3'): run_mhrf_lss_simulation works with basic parameters
Fixed regressor matrix is poorly conditioned (condition number = 1.41e+08). Added jitter = 2.03e-05 to diagonal.
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:8:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::prepare_lss_fixed_components_core(...) at manifold_hrf/R/validation_simulation.R:721:3

Warning ('test-validation-simulation.R:8:3'): run_mhrf_lss_simulation works with basic parameters
Z_confounds_matrix is rank deficient; using independent columns only
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:8:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::project_out_confounds_core(...) at manifold_hrf/R/validation_simulation.R:663:3

Warning ('test-validation-simulation.R:8:3'): run_mhrf_lss_simulation works with basic parameters
Fixed regressor matrix is poorly conditioned (condition number = 1.41e+08). Added jitter = 2.03e-05 to diagonal.
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:8:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::prepare_lss_fixed_components_core(...) at manifold_hrf/R/validation_simulation.R:721:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Target dimension 3 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/validation_simulation.R:652:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 1: Applied regularization due to condition number 4.70e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 2: Applied regularization due to condition number 2.63e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 3: Applied regularization due to condition number 3.69e+13
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 4: Applied regularization due to condition number 3.23e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 5: Applied regularization due to condition number 4.92e+11
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 6: Applied regularization due to condition number 1.34e+13
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 7: Applied regularization due to condition number 1.65e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 8: Applied regularization due to condition number 6.80e+11
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 9: Applied regularization due to condition number 9.32e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 10: Applied regularization due to condition number 4.18e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 11: Applied regularization due to condition number 1.71e+13
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 12: Applied regularization due to condition number 4.20e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 13: Applied regularization due to condition number 1.23e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 14: Applied regularization due to condition number 1.31e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 15: Applied regularization due to condition number 1.22e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 16: Applied regularization due to condition number 4.57e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 17: Applied regularization due to condition number 1.08e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 18: Applied regularization due to condition number 7.19e+11
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 19: Applied regularization due to condition number 1.54e+12
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:233:3'): run_pipeline_on_simulated_data integrates all components
Voxel 20: Applied regularization due to condition number 1.20e+13
Backtrace:
    ▆
 1. └─manifoldhrf:::run_pipeline_on_simulated_data(...) at test-validation-simulation.R:233:3
 2.   └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Target dimension 3 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/validation_simulation.R:652:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Z_confounds_matrix is rank deficient; using independent columns only
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::project_out_confounds_core(...) at manifold_hrf/R/validation_simulation.R:663:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 1: Applied regularization due to condition number 3.33e+14
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 2: Applied regularization due to condition number 2.57e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 3: Applied regularization due to condition number 1.19e+14
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 4: Applied regularization due to condition number 3.75e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 5: Applied regularization due to condition number 1.18e+14
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 6: Applied regularization due to condition number 1.24e+14
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 7: Applied regularization due to condition number 2.36e+14
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 8: Applied regularization due to condition number 2.41e+15
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 9: Applied regularization due to condition number 8.30e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 11: Applied regularization due to condition number 4.54e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 12: Applied regularization due to condition number 6.69e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 13: Applied regularization due to condition number 6.74e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 14: Applied regularization due to condition number 1.08e+14
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 15: Applied regularization due to condition number 2.18e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 16: Applied regularization due to condition number 4.57e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 17: Applied regularization due to condition number 2.18e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 18: Applied regularization due to condition number 4.84e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 19: Applied regularization due to condition number 5.04e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 20: Applied regularization due to condition number 8.28e+14
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Target dimension 3 is much lower than auto-selected 9 (for 95.0% variance)
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::get_manifold_basis_reconstructor_core(...) at manifold_hrf/R/validation_simulation.R:652:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Z_confounds_matrix is rank deficient; using independent columns only
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::project_out_confounds_core(...) at manifold_hrf/R/validation_simulation.R:663:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 1: Applied regularization due to condition number 2.38e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 2: Applied regularization due to condition number 2.52e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 3: Applied regularization due to condition number 4.31e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 4: Applied regularization due to condition number 9.39e+12
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 5: Applied regularization due to condition number 6.41e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 6: Applied regularization due to condition number 8.09e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 7: Applied regularization due to condition number 2.23e+14
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 8: Applied regularization due to condition number 3.62e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 9: Applied regularization due to condition number 5.10e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 10: Applied regularization due to condition number 2.29e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 11: Applied regularization due to condition number 2.92e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 12: Applied regularization due to condition number 4.19e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 13: Applied regularization due to condition number 5.91e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 14: Applied regularization due to condition number 5.12e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 15: Applied regularization due to condition number 3.82e+12
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 16: Applied regularization due to condition number 5.74e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 17: Applied regularization due to condition number 1.20e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 18: Applied regularization due to condition number 1.54e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 19: Applied regularization due to condition number 8.93e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3

Warning ('test-validation-simulation.R:391:3'): simulation parameters are validated
Voxel 20: Applied regularization due to condition number 1.48e+13
Backtrace:
    ▆
 1. └─manifoldhrf::run_mhrf_lss_simulation(...) at test-validation-simulation.R:391:3
 2.   └─manifoldhrf:::run_pipeline_on_simulated_data(...) at manifold_hrf/R/validation_simulation.R:146:5
 3.     └─manifoldhrf::extract_xi_beta_raw_svd_core(...) at manifold_hrf/R/validation_simulation.R:684:3
 4.       └─manifoldhrf::extract_xi_beta_raw_svd_robust(...) at manifold_hrf/R/core_voxelwise_fit.R:531:3
────────────────────────────────────────────────────────────────────────────────

⠏ |          0 | voxelwise-fit                                                  
⠧ |        118 | voxelwise-fit                                                  
⠼ |        325 | voxelwise-fit                                                  
✔ |        331 | voxelwise-fit

⠏ |          0 | woodbury-mathematical-verification                             
=== Beta Estimates ===
True betas:      2 -1 1.5 0.5 
Direct LSS:      2.1316 -1.2271 1.5903 0 
Woodbury:        1.5368 -1.4728 1.4954 0 
Manual:          2.1316 -1.2271 1.5904 0 

=== Differences from Direct ===
Woodbury diff:   -0.594858 -0.24566 -0.094959 0 
Manual diff:     -2.3e-05 1.3e-05 2e-05 0 

=== Debugging Woodbury Implementation ===
C_v shape:  50 4 
U_v shape:  3 4 
V_regressors_v shape:  50 4 
Projection error:  2.015873e-15 

pc_v_row:  0.0989 -0.006 -0.0375 0 
cv_v_row:  0.1148 0.1382 0.1374 0 
alpha_v_row:  7.8493 7.2811 7.5524 4.5036e+15 

=== Comparison of Methods ===
True betas:       0.328 1.311 1.4 0.306 0.643 0.838 
Direct LSS:       -0.989 0.933 1.896 0.123 1.351 1.688 
Corrected Wood:   -0.989 0.933 1.896 0.123 1.351 1.688 
Current Wood:     -0.927 0.703 1.469 -0.41 0.797 1.195 

=== Errors ===
Direct error:     0.7507 
Corrected error:  0.7507 
Current error:    0.66 

Max diff (corrected vs direct):  2.687395e-06 

✔ |          2 | woodbury-mathematical-verification

══ Results ═════════════════════════════════════════════════════════════════════
Duration: 15.6 s

── Skipped tests (6) ───────────────────────────────────────────────────────────
• empty test (2): 'test-lss-correction-validation.R:131:1',
  'test-mhrf-lss-interface.R:3:1'
• HRF correlation test is too sensitive to random initialization (1):
  'test-fmrireg-benchmarks.R:167:3'
• Neuroimaging dimension mismatch - fixing in next iteration (1):
  'test-neuroimaging-wrappers.R:246:3'
• RcppHNSW installed; cannot test fallback (1):
  'test-manifold-construction.R:277:3'
• Requires fmrireg integration (1): 'test-mhrf-lss-interface.R:102:3'

── Failed tests ────────────────────────────────────────────────────────────────
Failure ('test-lss-correction-validation.R:126:3'): Corrected LSS implementation matches ground truth
Corrected implementation should match simultaneous estimation is not strictly less than 1e-04. Difference: 0.324

Failure ('test-lss-separate.R:100:3'): run_lss_for_voxel_corrected_full matches LS-S
`beta_full` not equal to `beta_manual`.
Attributes: < Modes: list, NULL >
Attributes: < Lengths: 1, 0 >
Attributes: < names for target but not for current >
Attributes: < current is not list-like >

Failure ('test-lss.R:288:3'): run_lss_for_voxel_corrected_full validates inputs
`run_lss_for_voxel_corrected_full(...)` did not throw an error.

[ FAIL 3 | WARN 173 | SKIP 6 | PASS 1123 ]
Warning message:
package ‘testthat’ was built under R version 4.3.3 
> 
> 
