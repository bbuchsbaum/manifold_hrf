% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_manifold_construction.R
\name{get_manifold_basis_reconstructor_core}
\alias{get_manifold_basis_reconstructor_core}
\title{Get Manifold Basis Reconstructor (Core)}
\usage{
get_manifold_basis_reconstructor_core(
  S_markov_matrix,
  L_library_matrix,
  m_manifold_dim_target,
  m_manifold_dim_min_variance = 0.95
)
}
\arguments{
\item{S_markov_matrix}{N x N Markov matrix from calculate_manifold_affinity_core}

\item{L_library_matrix}{p x N matrix of HRF shapes (same as used for S_markov_matrix)}

\item{m_manifold_dim_target}{Target manifold dimensionality (e.g., 3-5)}

\item{m_manifold_dim_min_variance}{Minimum variance explained threshold (default 0.95)}
}
\value{
A list containing:
\itemize{
\item \code{B_reconstructor_matrix}: p x m matrix mapping manifold coords to HRF shapes
\item \code{Phi_coords_matrix}: N x m matrix of diffusion map coordinates
\item \code{eigenvalues_S_vector}: Vector of eigenvalues from S decomposition
\item \code{m_final_dim}: Final manifold dimension used
\item \code{m_auto_selected_dim}: Automatically selected dimension based on variance
}
}
\description{
Computes diffusion map coordinates and HRF reconstructor matrix for the manifold.
}
\details{
This function implements Component 0, Steps 3-5 of the M-HRF-LSS pipeline.
It computes the diffusion map embedding of the HRF library and creates a
reconstructor matrix that maps low-dimensional manifold coordinates back to
full HRF shapes.
}
\examples{
\dontrun{
# Create synthetic HRF library and compute manifold
p <- 30
N <- 100
L_library <- matrix(rnorm(p * N), nrow = p, ncol = N)
S <- calculate_manifold_affinity_core(L_library, k_local_nn_for_sigma = 7)

# Get manifold basis
manifold <- get_manifold_basis_reconstructor_core(
  S, L_library, 
  m_manifold_dim_target = 5,
  m_manifold_dim_min_variance = 0.95
)
}

}
