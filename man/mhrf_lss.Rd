% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mhrf_lss_interface.R, R/simple_interface.R
\name{mhrf_lss}
\alias{mhrf_lss}
\title{Fit M-HRF-LSS Model}
\usage{
mhrf_lss(
  Y_bold,
  X_condition_list,
  X_trial_list,
  Z_confounds = NULL,
  voxel_coordinates = NULL,
  TR = 2,
  parameters = mhrf_lss_parameters()
)

mhrf_lss(
  Y_bold,
  X_condition_list,
  X_trial_list,
  Z_confounds = NULL,
  voxel_coordinates = NULL,
  TR = 2,
  parameters = mhrf_lss_parameters()
)
}
\arguments{
\item{Y_bold}{Numeric matrix of BOLD time series (time \eqn{\times} voxels).}

\item{X_condition_list}{List of condition-level design matrices.}

\item{X_trial_list}{List of trial-level design matrices.}

\item{Z_confounds}{Optional matrix of confound regressors.}

\item{voxel_coordinates}{Optional matrix of voxel coordinates for
spatial smoothing.}

\item{TR}{Repetition time in seconds.}

\item{parameters}{List of algorithm parameters as created by
\code{mhrf_lss_parameters()}.}

\item{formula}{Formula specification for event model (same as fmrireg)}

\item{dataset}{An fmri_dataset object from fmrireg}

\item{baseline_model}{Optional baseline model from fmrireg::baseline_model()}

\item{hrf_library}{Source for HRF library. Can be:
\itemize{
\item Character: "canonical" (uses fmrireg HRFs), "flobs", "gamma_grid"
\item List of fmrireg HRF objects (e.g., list(HRF_SPMG1, HRF_GAMMA))
\item Matrix of HRF shapes (p x N)
\item Path to saved HRF library
}}

\item{manifold_params}{List of manifold construction parameters or preset name}

\item{estimation}{What to estimate: "condition", "trial", or "both"}

\item{spatial_info}{Optional NeuroSpace or voxel coordinates for spatial smoothing}

\item{strategy}{Processing strategy: "global", "runwise", "chunked"}

\item{nchunks}{Number of chunks for memory efficiency}

\item{robust}{Use robust estimation (downweight outliers)}

\item{progress}{Show progress bar}

\item{verbose}{Print detailed messages}

\item{...}{Additional arguments}
}
\value{
An \code{mhrf_lss_result} object with components:
\describe{
\item{parameters}{List of parameter settings used}
\item{manifold}{HRF manifold object}
\item{hrf}{List of raw and smoothed HRF matrices}
\item{beta}{List of condition and trial beta estimates}
\item{qc}{Quality control metrics}
\item{diagnostics}{Additional diagnostic information}
}

List with M-HRF-LSS results.
}
\description{
Deprecated wrapper for \code{mhrf_analyze}. Use that function
in new code.

This wrapper provides a streamlined interface for running the
M-HRF-LSS algorithm when design matrices are already available.
}
\details{
Main interface for manifold-guided HRF estimation and trial-wise deconvolution.
Follows fmrireg patterns but extends with manifold-based HRF estimation.
}
\examples{
\dontrun{
# Load fmrireg for dataset creation
library(fmrireg)

# Create dataset (using fmrireg)
dset <- fmri_dataset(
  scans = "bold.nii.gz",
  mask = "mask.nii.gz", 
  TR = 2,
  run_length = c(200, 200)
)

# Basic M-HRF-LSS fit
fit <- mhrf_lss(
  ~ hrf(condition),
  dataset = dset,
  hrf_library = "canonical",
  estimation = "both"
)

# Advanced with custom parameters
fit_custom <- mhrf_lss(
  ~ hrf(cond1) + hrf(cond2),
  dataset = dset,
  baseline_model = baseline_model(degree = 2),
  hrf_library = list(HRF_SPMG1, HRF_SPMG2, HRF_SPMG3, HRF_GAMMA),
  manifold_params = "balanced",  # or custom list
  spatial_info = dset$mask,
  robust = TRUE
)

# Access estimated HRFs
head(fit$hrf$smoothed)
}

}
\keyword{internal}
