% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_lss_deprecated.R
\name{reconstruct_hrf_shapes_core}
\alias{reconstruct_hrf_shapes_core}
\title{Reconstruct HRF Shapes from Manifold Coordinates (Core)}
\usage{
reconstruct_hrf_shapes_core(B_reconstructor_matrix, Xi_smoothed_matrix)
}
\arguments{
\item{B_reconstructor_matrix}{The p x m HRF reconstructor matrix from
Component 0, where p is HRF length and m is manifold dimensionality}

\item{Xi_smoothed_matrix}{The m x V matrix of spatially smoothed manifold
coordinates from Component 2, where V is number of voxels}
}
\value{
H_shapes_allvox_matrix A p x V matrix where each column is the
reconstructed HRF shape for a voxel
}
\description{
Reconstructs voxel-specific HRF shapes by multiplying the HRF basis
reconstructor matrix with spatially smoothed manifold coordinates.
}
\details{
This function implements Component 3, Step 2 of the M-HRF-LSS pipeline.
It transforms the low-dimensional manifold representation back to the full
HRF shape space. The resulting HRF shapes are used to create voxel-specific
regressors for the LSS estimation.
}
\examples{
\dontrun{
# Example with synthetic data
p <- 30   # HRF length
m <- 5    # manifold dimensions
V <- 100  # voxels

# Example reconstructor (would come from Component 0)
B_reconstructor <- matrix(rnorm(p * m), p, m)

# Example smoothed manifold coordinates (would come from Component 2)
Xi_smoothed <- matrix(rnorm(m * V), m, V)

# Reconstruct HRF shapes
H_shapes <- reconstruct_hrf_shapes_core(B_reconstructor, Xi_smoothed)
# Result is 30 x 100 matrix (HRF samples x voxels)
}

}
