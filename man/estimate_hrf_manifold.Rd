% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_hrf_manifold.R
\name{estimate_hrf_manifold}
\alias{estimate_hrf_manifold}
\title{Estimate HRF Using Manifold Learning}
\usage{
estimate_hrf_manifold(
  fmri_data,
  events,
  TR,
  hrf_library = "fir",
  mask = NULL,
  control = manifold_control()
)
}
\arguments{
\item{fmri_data}{A 4D neuroimaging array, NeuroVec object, or matrix (timepoints x voxels)}

\item{events}{Data frame with columns 'onset', 'condition', and optionally 'duration'}

\item{TR}{Repetition time in seconds}

\item{hrf_library}{Either a string preset ("fir", "gamma", "custom") or a matrix/list
of HRF basis functions}

\item{mask}{Optional brain mask (3D array or NeuroVol). If NULL, all non-zero voxels are used}

\item{control}{A list of control parameters from \code{\link{manifold_control}}}
}
\value{
A \code{\link{manifold_hrf_fit}} object containing:
\itemize{
\item \code{amplitudes}: Condition-level amplitude estimates
\item \code{trial_amplitudes}: Trial-wise amplitude estimates
\item \code{hrf_shapes}: Estimated HRF shapes for each voxel
\item \code{fitted_values}: Model predictions
\item \code{residuals}: Model residuals
\item Additional model details in \code{model_specific}
}
}
\description{
Primary user-facing function for manifold-guided HRF estimation.
Estimates voxel-specific hemodynamic response functions using manifold learning
to constrain the space of possible HRF shapes.
}
\examples{
\dontrun{
# Basic usage with default settings
fit <- estimate_hrf_manifold(
  fmri_data = bold_data,
  events = event_df,
  TR = 2.0,
  hrf_library = "fir"
)

# Custom control parameters
ctrl <- manifold_control(
  preset = "fast",
  lambda_spatial_smooth = 1.0
)

fit <- estimate_hrf_manifold(
  fmri_data = bold_data,
  events = event_df,
  TR = 2.0,
  hrf_library = "gamma",
  control = ctrl
)

# View results
print(fit)
summary(fit)
plot(fit, type = "hrf")
}

}
\seealso{
\code{\link{manifold_control}}, \code{\link{manifold_hrf_fit}}
}
