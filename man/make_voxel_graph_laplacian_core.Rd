% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_spatial_smoothing.R
\name{make_voxel_graph_laplacian_core}
\alias{make_voxel_graph_laplacian_core}
\title{Construct Graph Laplacian for Voxel Coordinates (Core)}
\usage{
make_voxel_graph_laplacian_core(voxel_coords_matrix, num_neighbors_Lsp)
}
\arguments{
\item{voxel_coords_matrix}{A V x 3 matrix of voxel coordinates, where V is
the number of voxels and columns are x, y, z coordinates}

\item{num_neighbors_Lsp}{Number of nearest neighbors for graph construction
(e.g., 6 for face-connected, 18 for edge-connected, 26 for corner-connected)}
}
\value{
L_sp_sparse_matrix A V x V sparse Laplacian matrix (Matrix::sparseMatrix)
}
\description{
Creates a sparse graph Laplacian matrix for spatial smoothing based on
k-nearest neighbors in 3D voxel space.
}
\details{
This function implements Component 2, Step 1 of the M-HRF-LSS pipeline.
It constructs a k-nearest neighbor graph from voxel coordinates and computes
the normalized graph Laplacian L = D - W, where W is the adjacency matrix
and D is the degree matrix. The resulting Laplacian is used for spatial
smoothing of manifold coordinates.
}
\examples{
\dontrun{
# Create example 3D grid of voxels
coords <- expand.grid(x = 1:10, y = 1:10, z = 1:5)
voxel_coords <- as.matrix(coords)

# Construct 6-neighbor Laplacian (face-connected)
L_sparse <- make_voxel_graph_laplacian_core(voxel_coords, num_neighbors_Lsp = 6)

# Construct 26-neighbor Laplacian (corner-connected)
L_sparse_full <- make_voxel_graph_laplacian_core(voxel_coords, num_neighbors_Lsp = 26)
}

}
