% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_lss.R
\name{run_lss_voxel_loop_core}
\alias{run_lss_voxel_loop_core}
\title{Run LSS voxel loop with memory optimization strategies}
\usage{
run_lss_voxel_loop_core(
  Y_proj_matrix,
  X_trial_onset_list_of_matrices,
  B_reconstructor_matrix,
  Xi_smoothed_allvox_matrix,
  A_lss_fixed_matrix = NULL,
  memory_strategy = "auto",
  chunk_size = 50,
  ram_limit_GB = 4,
  n_cores = 1,
  progress = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{Y_proj_matrix}{n x V matrix of projected BOLD data}

\item{X_trial_onset_list_of_matrices}{List of T sparse matrices (n x p each)}

\item{B_reconstructor_matrix}{p x m manifold basis matrix}

\item{Xi_smoothed_allvox_matrix}{m x V smoothed manifold coordinates}

\item{A_lss_fixed_matrix}{Optional n x q fixed regressors matrix}

\item{memory_strategy}{Character string specifying computation method:
\itemize{
\item{"auto"}{ (Default) Automatically selects based on data size}
\item{"full"}{ Precomputes all trial regressors. Fastest but uses most memory}
\item{"chunked"}{ Processes trials in batches. Good balance of speed/memory}
\item{"streaming"}{ Processes one trial at a time. Lowest memory usage}
}}

\item{chunk_size}{Integer number of trials per chunk when using "chunked" strategy}

\item{ram_limit_GB}{Memory limit in GB for auto strategy selection}

\item{n_cores}{Number of CPU cores to use for parallel processing (1 = sequential)}

\item{progress}{Logical whether to show progress bar (requires progressr package)}

\item{verbose}{Logical whether to print progress messages}
}
\value{
T x V matrix of trial-wise beta estimates
}
\description{
Main dispatcher function that performs trial-wise LSS estimation using
one of three memory strategies based on dataset size and available resources.
}
