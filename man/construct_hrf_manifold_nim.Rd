% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/neuroimaging_wrappers.R
\name{construct_hrf_manifold_nim}
\alias{construct_hrf_manifold_nim}
\title{Construct HRF Manifold (Neuroimaging Wrapper)}
\usage{
construct_hrf_manifold_nim(
  hrf_library_source,
  TR_precision = 0.1,
  hrf_duration = 24,
  m_manifold_dim_target = 5,
  m_manifold_dim_min_variance = 0.95,
  k_local_nn_for_sigma = 7,
  sparse_threshold = 5000,
  ...
)
}
\arguments{
\item{hrf_library_source}{Source for HRF library. Can be:
\itemize{
\item Character string: "FLOBS", "half_cosine", "gamma_grid", or path to RDS file
\item List of fmrireg HRF objects
\item Matrix (p x N) of HRF shapes
}}

\item{TR_precision}{Time resolution in seconds for HRF evaluation (e.g., 0.1)}

\item{hrf_duration}{Total duration of HRF in seconds (default 24)}

\item{m_manifold_dim_target}{Target manifold dimensionality (default 5)}

\item{m_manifold_dim_min_variance}{Minimum variance explained (default 0.95)}

\item{k_local_nn_for_sigma}{k-NN for self-tuning bandwidth (default 7)}

\item{sparse_threshold}{Library size above which to use sparse matrices (default 5000)}

\item{...}{Additional parameters passed to core functions}
}
\value{
A list containing:
\itemize{
\item \code{B_reconstructor_matrix}: p x m HRF reconstructor matrix
\item \code{manifold_hrf_basis}: Custom fmrireg HRF object for the manifold basis
\item \code{Phi_coords_matrix}: N x m manifold coordinates of library HRFs
\item \code{eigenvalues_S}: Eigenvalues from diffusion map
\item \code{m_manifold_dim}: Final manifold dimensionality used
\item \code{m_auto_selected}: Automatically selected dimensionality
\item \code{library_info}: Information about the HRF library used
\item \code{parameters}: List of all parameters used
}
}
\description{
Creates an HRF manifold from various neuroimaging-compatible sources,
wrapping the core manifold construction functions with fmrireg integration.
}
\details{
This function provides a neuroimaging-friendly interface to the core
manifold construction pipeline. It handles conversion between fmrireg HRF
objects and the matrix format required by core functions. When a list of
\code{fmrireg} HRF objects is supplied, each HRF is sampled with
\code{fmrireg::evaluate()} at the requested precision to build the library
matrix. The resulting manifold basis can be used directly in fmrireg model
specifications.
}
\examples{
\dontrun{
# Use FLOBS basis
manifold_flobs <- construct_hrf_manifold_nim(
  hrf_library_source = "FLOBS",
  TR_precision = 0.1,
  m_manifold_dim_target = 5
)

# Use custom HRF objects from fmrireg
hrf_list <- list(
  fmrireg::HRF_SPMG1,
  fmrireg::HRF_SPMG2,
  fmrireg::HRF_SPMG3,
  fmrireg::HRF_GAMMA
)
manifold_custom <- construct_hrf_manifold_nim(
  hrf_library_source = hrf_list,
  TR_precision = 0.5
)

# Use in fmrireg model
# event_model(~ hrf(onset, basis = manifold_custom$manifold_hrf_basis))
}

}
